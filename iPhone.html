　　<html>
    　　<head>
        <TITLE>请填完该表，生成iphone预约代码</TITLE>
        　　</head>
    　　<body>
        
        
        
        <div align="center">
            
            <form>
                <input id="gold" type="radio" name="color" value="金" checked>金色<br>
                <input id="silver" type="radio" name="color" value="银">银色<br>
                <input id="gray" type="radio" name="color" value="灰">灰色<br>
                            
                            <hr>
                            
                            
                            <input id="small" type="radio" name="capacity" value="16" checked>16GB<br>
                            <input id="mid" type="radio" name="capacity" value="32">32GB<br>
                            <input id="big" type="radio" name="capacity" value="64">64GB<br>
                                        
                            <hr>
                                        
                                        
                                        <input id="hk" type="radio" class="city" name="city" onclick="city_change()" value="香港" checked>香港<br>
                                        <input id="bj" type="radio"  class="city" name="city" onclick="city_change()" value="北京">北京<br>
                                        <input id="sh" type="radio"  class="city" name="city" onclick="city_change()" value="上海">上海<br>
                                        <input id="sz" type="radio"  class="city" name="city" onclick="city_change()" value="深圳">深圳<br>
                                        <input id="cd" type="radio" class="city"  name="city" onclick="city_change()" value="成都">成都<br>
                                                            
                                        <hr>
                                        <form>
                                          <input id="hk-unlocked" type="radio" class="carrier" name="carrier" onclick="carrier_change()" value="香港" checked>港行无锁<br>
                                          <input id="lt-unlocked" type="radio"  class="carrier" name="carrier" onclick="carrier_change()" value="联通">联通无锁<br>
                                          <input id="dx-unlocked" type="radio" class="carrier"  name="carrier" onclick="carrier_change()" value="电信">电信无锁<br>
                                        </form>
                                        <hr>
                                                            </strong>取机时间: <strong>
                                                                <select id="pickup_time">
                                                                  <option value="1">1:00 下午 - 2:00 下午</option>
                                                                  <option value="2">2:00 下午 - 3:00 下午</option>
                                                                    <option value="3" selected>3:00 下午 - 4:00 下午</option>
                                                                    <option value="4">4:00 下午 - 5:00 下午</option>
                                                                    <option value="5">5:00 下午 - 6:00 下午</option>
                                                                    <option value="6">6:00 下午 - 7:00 下午</option>
                                                                    <option value="7">7:00 下午 - 8:00 下午</option>
                                                                    <option value="8">8:00 下午 - 9:00 下午</option>
                                                                    <option value="9">9:00 下午 - 10:00 下午</option>
                                                                    
                                                                </select>
                                                                <hr>
                                                                
                                                                
                                                                <h3>个人信息:</h3>
                                                                <table><tbody>
                                                                    <tr>
                                                                        <td>姓:</td><td><input id="lastname" type="text" name="lastname"></td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td>名:</td><td><input id="firstname"  type="text" name="firstname"></td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td>email: </td><td><input  id="email" type="text" name="email"></td>
                                                                        <tr>
                                                                            <td>电话: </td><td><input  id="phone" type="text" name="phone"></td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td>身份证: </td><td><input  id="govid" type="text" name="govid"></td>
                                                                        </tr>
                                                                        </tbody></table>
                                                                
                                                                
                                                                <hr>
                                                                <br>
                                                                　　<input type="button" onclick="openwin()" value="生成iphone预定脚本">
                                                                    </div>
        
        　　</body>
    
    　　<SCRIPT LANGUAGE="javascript">
        
        var city = null;
        var carrier = null;
        var capacity = null;
        var pickup_time = null;
        var color = null;
        var firstname = null;
        var lastname = null;
        var email = null
        var phone = null;
        var govid = null;
        
	function city_change(){
		if( check_radio( "city" ) == "香港" ){
			document.getElementById("hk-unlocked").checked=true;
			document.getElementById("hk-unlocked").disabled=false;
			document.getElementById("lt-unlocked").disabled=true;
			document.getElementById("dx-unlocked").disabled=true;
			
			<!-- document.getElementById("mid").disabled=false; -->
			<!-- document.getElementById("big").disabled=false; -->
	
		}else{
			if( (tmp_city = check_radio( "carrier" )) == "香港" ){
				document.getElementById("lt-unlocked").checked=true;
			}
			document.getElementById("hk-unlocked").disabled=true;
			document.getElementById("lt-unlocked").disabled=false;
			document.getElementById("dx-unlocked").disabled=false;
						
			<!-- if( check_radio( "color" ) == "灰" ){ -->
			<!-- 	document.getElementById("mid").disabled=true; -->
			<!-- 	document.getElementById("big").disabled=true; -->
			<!-- } -->
		}
	}

	
	function carrier_change(){
		if( check_radio( "carrier" ) == "香港" ){
			document.getElementById("hk").checked=true;
		}else{
			document.getElementById("bj").checked=true;
		}
	}

        
	function check_radio( radioname ){
            var radio_item = document.getElementsByName(radioname);
            for (var i=0; i<radio_item.length; i++)
            {
                if(radio_item[i].checked){
                    return radio_item[i].value;
                }
            }
            return null;
        }
        
        function check_combbox( id ){
            var items = document.getElementById(id);
            for (var i=0; i<items.length; i++)
            {
                if( items[i].selected ){
                    return items[i].value;
                }
            }
            return null;
        }

       
        function check_all_entries(){
            if( (color = check_radio( "color" )) == null ){
                alert( "请选择颜色" );
               return false;
            }
            if( (capacity = check_radio( "capacity" )) == null ){
                alert( "请选择容量" );
                return false;
            }
            if( (city = check_radio( "city" )) == null ){
                alert( "请选择城市" );
                return false;
            }
            if( (carrier = check_radio( "carrier" )) == null ){
                alert( "请选择运营商" );
                return false;
            }
            if( (pickup_time = check_combbox( "pickup_time" )) == null ){
                alert( "请选择取机时间" );
                return false;
            }
            if( (firstname = document.getElementById( "firstname" ).value) == null ){
                alert( "请填写姓名" );
                return false;
            }
            if( (lastname = document.getElementById( "lastname" ).value) == null ){
                alert( "请填写姓名" );
                return false;
            }
            alert

            if( (email = document.getElementById( "email" ).value) == null ){
                alert( "请填写email" );
                return false;
            }

            if( (phone = document.getElementById( "phone" ).value) == null ){
                alert( "请填写手机号" );
                return false;
            }
            if( (govid = document.getElementById( "govid" ).value) == null ){
                alert( "请填写身份证号" );
                return false;
            }

        }
        
        function openwin(){
            if( check_all_entries() == false )
                return;
           
            //生成
            OpenWindow=window.open("", "newwin", "height=600, width=800,toolbar=no,scrollbars="+scroll+",menubar=no");
            　　OpenWindow.document.write("<TITLE>iphone预约代码</TITLE>");
        
            　　//OpenWindow.document.write( "<textarea style=\"font-size:14px\" readonly=\"readonly\" rows=\"60\" cols=\"105\">" );
                OpenWindow.document.write( "<textarea readonly=\"readonly\" rows=\"40\" cols=\"109\">" );
            　　OpenWindow.document.write( "var lastName_g = '" + lastname + "';\n" );
            　　OpenWindow.document.write( "var firstName_g = '" + firstname + "';\n"  );
            　　OpenWindow.document.write( "var emailAddress_g = '" + email  + "';\n" );
            　　OpenWindow.document.write( "var phoneNumber_g = '" + phone  + "';\n" );
            　　OpenWindow.document.write( "var governmentID_g = '" + govid  + "';\n" );
            　　OpenWindow.document.write( "var color_g = '" + color + "';\n"  );
            　　OpenWindow.document.write( "var capacity_g = '" + capacity  + "';\n" );
            　　OpenWindow.document.write( "var carrier_g = '" + carrier + "';\n"  );
            　　OpenWindow.document.write( "var pickup_city_g = '" + city  + "';\n" );
            　　OpenWindow.document.write( "var startime_g = " + pickup_time  + ";\n" );
            write_file();

            　　OpenWindow.document.write( "</textarea>" );

            　　OpenWindow.document.write("</BODY>");
            　　OpenWindow.document.write("</HTML>");
            　　OpenWindow.document.close();
        }
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        //不要该函数的位置，它必须在最后，用于bash处理。bash处理过程是先计算出这行，然后出书这行之前的所有内容，
         //接着后读入一个文件填充该函数，最后输出一行 "}\< /SCRIPT></html>" 结束
        function write_file(){
OpenWindow.document.write( "/* 一下内容需要保持在50行一下，用于bash处理 */\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "var selectedStore_g         = null;\n" );
OpenWindow.document.write( "var storeName_g             = null;\n" );
OpenWindow.document.write( "var partNumber_g            = null;\n" );
OpenWindow.document.write( "var skuName_g               = null;\n" );
OpenWindow.document.write( "var timeslotid_g            = null;\n" );
OpenWindow.document.write( "var timeSlotStartTime_g     = null;         //jQuery('#hiddenTimeSlot').val().split(',')[2];\n" );
OpenWindow.document.write( "var pickUpSlot_g            = null;         //jQuery('.step-seven .selection').html()\n" );
OpenWindow.document.write( "var plan_g                  = \"UNLOCKED\";   //jQuery('.carrier-row').find(' input ').val();     TODO\n" );
OpenWindow.document.write( "var selectedSubProduct_g    = 'iPhone 5s';\n" );
OpenWindow.document.write( "var pickupMode_g            = 'POST_LAUNCH';\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "function van_getTimeslots() {\n" );
OpenWindow.document.write( "    var timeslots = [];\n" );
OpenWindow.document.write( "    var startime_tmp = null;\n" );
OpenWindow.document.write( "	var dataString = 'productName=' + selectedSubProduct_g + '&storeNumber=' + selectedStore_g +'&plan='+ plan_g + '&mode=' + pickupMode_g;\n" );
OpenWindow.document.write( "    var i = 0;\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    jQuery.ajax({\n" );
OpenWindow.document.write( "                type: \"POST\",\n" );
OpenWindow.document.write( "                async: false,\n" );
OpenWindow.document.write( "                url: \"getTimeSlots\",\n" );
OpenWindow.document.write( "                dataType : \"json\",\n" );
OpenWindow.document.write( "                data: dataString,\n" );
OpenWindow.document.write( "                success: function(data) {\n" );
OpenWindow.document.write( "                if (data.timeSlots != null) {\n" );
OpenWindow.document.write( "                \n" );
OpenWindow.document.write( "                console.log( \"POST(gettimeslots) success1\" );\n" );
OpenWindow.document.write( "                timeslots = data.timeSlots;	\n" );
OpenWindow.document.write( "                for( i = startime_g; i < 12 && timeslotid_g == null; i++ ){\n" );
OpenWindow.document.write( "                startime_tmp = i + ':00 下午';\n" );
OpenWindow.document.write( "                \n" );
OpenWindow.document.write( "                jQuery.each(timeslots, function(index, val) {\n" );
OpenWindow.document.write( "                            console.log( val.formattedTimeForDisplay + \": \" + val.timeslotID + ', ' + val.timeslotDate+ ', ' + val.startTime );\n" );
OpenWindow.document.write( "                            \n" );
OpenWindow.document.write( "                            if( val.formattedTimeForDisplay.split(' - ')[0] == startime_tmp ){\n" );
OpenWindow.document.write( "                            timeSlotStartTime_g = val.startTime;\n" );
OpenWindow.document.write( "                            timeslotid_g = val.timeslotID;\n" );
OpenWindow.document.write( "                            pickUpSlot_g = val.formattedTimeForDisplay;\n" );
OpenWindow.document.write( "                            \n" );
OpenWindow.document.write( "                            console.log( \"      getTimeSlots success. \" + pickUpSlot_g + \": \" + timeslotid_g + ', ' + timeSlotStartTime_g );\n" );
OpenWindow.document.write( "                            return false;\n" );
OpenWindow.document.write( "                            } \n" );
OpenWindow.document.write( "                            });\n" );
OpenWindow.document.write( "                \n" );
OpenWindow.document.write( "                }//for\n" );
OpenWindow.document.write( "                } \n" );
OpenWindow.document.write( "                console.log( \"POST(gettimeslots) success2\" );\n" );
OpenWindow.document.write( "                },\n" );
OpenWindow.document.write( "                error: function () {\n" );
OpenWindow.document.write( "                console.log( \"POST(getTimeSlots) error\" );\n" );
OpenWindow.document.write( "                } 		\n" );
OpenWindow.document.write( "                \n" );
OpenWindow.document.write( "                \n" );
OpenWindow.document.write( "                });\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    if( timeslotid_g == null )\n" );
OpenWindow.document.write( "        return false;\n" );
OpenWindow.document.write( "    else\n" );
OpenWindow.document.write( "        return true;\n" );
OpenWindow.document.write( "}\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "function van_onSubmitRequest() {\n" );
OpenWindow.document.write( "    var quantity        = 1;                           //parseInt(jQuery('.step-five .selection').html());\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    var dataString = {emailAddress:emailAddress_g, firstName:firstName_g, lastName:lastName_g, phoneNumber:phoneNumber_g, storeNumber:selectedStore_g, partNumber:partNumber_g, pickUpMode:pickupMode_g, timeSlotId:timeslotid_g, plan:plan_g, productName:selectedSubProduct_g, quantity:quantity, govtID:governmentID_g, startTime:timeSlotStartTime_g, skuName:skuName_g, pickUpSlot:pickUpSlot_g};\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    jQuery.ajax({\n" );
OpenWindow.document.write( "                type : \"POST\",\n" );
OpenWindow.document.write( "                url : \"createPickUp\",\n" );
OpenWindow.document.write( "                dataType : \"json\",\n" );
OpenWindow.document.write( "                contentType: \"application/json\",\n" );
OpenWindow.document.write( "                data : JSON.stringify(dataString)\n" );
OpenWindow.document.write( "                }).done(function(data){\n" );
OpenWindow.document.write( "                        if (data != null) {\n" );
OpenWindow.document.write( "                        if (data.isError) {\n" );
OpenWindow.document.write( "                        if(data.loginRedirectUrl) {\n" );
OpenWindow.document.write( "                        window.location = data.loginRedirectUrl;\n" );
OpenWindow.document.write( "                        console.log( \"POST(createPickUp) error1: loginRedirectUrl\" );\n" );
OpenWindow.document.write( "                        } else {\n" );
OpenWindow.document.write( "                        console.log( \"POST(createPickUp) error2: \" + data.errorMessage );\n" );
OpenWindow.document.write( "                        jQuery(\"#error\").show();\n" );
OpenWindow.document.write( "                        jQuery(\"#errorMessage\").parent().show();\n" );
OpenWindow.document.write( "                        jQuery(\"#errorMessage\").text(data.errorMessage);\n" );
OpenWindow.document.write( "                        jQuery(\"#errMessage\").hide();		\n" );
OpenWindow.document.write( "                        jQuery(\"#errorMessage\").show();\n" );
OpenWindow.document.write( "                        //Clear Captcha \n" );
OpenWindow.document.write( "                        CaptchaProcess.getCaptcha();\n" );
OpenWindow.document.write( "                        }\n" );
OpenWindow.document.write( "                        } else {\n" );
OpenWindow.document.write( "                        \n" );
OpenWindow.document.write( "                        var stitle3 = null;\n" );
OpenWindow.document.write( "                        stitle3 = \"HK$ 5,588\";\n" );
OpenWindow.document.write( "                        \n" );
OpenWindow.document.write( "                        console.log( \"POST(createPickUp) success\" );\n" );
OpenWindow.document.write( "                        jQuery('#productName').val(quantity + \" \" + skuName_g);   //\n" );
OpenWindow.document.write( "                        jQuery('#pickupMode').val(pickupMode_g);       //(pickupMode_g);  \n" );
OpenWindow.document.write( "                        jQuery('#pickUpSlot').val(pickUpSlot_g);     //(jQuery('.step-seven .selection').html());\n" );
OpenWindow.document.write( "                        jQuery('#storeName').val(storeName_g);        //(jQuery('.step-one .selection').html());\n" );
OpenWindow.document.write( "                        jQuery('#pickupDateAndTimeText').val(data.pickupDateAndTimeText);\n" );
OpenWindow.document.write( "                        jQuery('#storeMapUrl').val(data.storeMapUrl);\n" );
OpenWindow.document.write( "                        jQuery('#tagName').val(location.href.split('/')[location.href.split('/').length - 2]);\n" );
OpenWindow.document.write( "                        jQuery('#pickUpForm').submit();\n" );
OpenWindow.document.write( "                        }\n" );
OpenWindow.document.write( "                        }\n" );
OpenWindow.document.write( "                        \n" );
OpenWindow.document.write( "                        }).fail(function(jqXHR, textStatus, errorThrown) {\n" );
OpenWindow.document.write( "                                console.log( \"POST(createPickUp) error3: fail\" );\n" );
OpenWindow.document.write( "                                console.error(jqXHR, textStatus, errorThrown);\n" );
OpenWindow.document.write( "                                //Clear Captcha \n" );
OpenWindow.document.write( "                                CaptchaProcess.getCaptcha();\n" );
OpenWindow.document.write( "                                }).always(function() {\n" );
OpenWindow.document.write( "                                          });\n" );
OpenWindow.document.write( "	\n" );
OpenWindow.document.write( "}\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "function van_check_available( sku, partNum ) {\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    var partNum_enabled = false;\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    jQuery.each(sku, function(product,productData) {\n" );
OpenWindow.document.write( "        jQuery.each(productData, function(color,colorData) {	\n" );
OpenWindow.document.write( "            console.log( color );\n" );
OpenWindow.document.write( "            \n" );
OpenWindow.document.write( "            jQuery.each(colorData, function(sTitle1,sTitle1Data) { \n" );
OpenWindow.document.write( "                jQuery.each(sTitle1Data, function(carrier,carrierData) { \n" );
OpenWindow.document.write( "                    if( carrier.toLowerCase() == 'unlocked' ){\n" );
OpenWindow.document.write( "                        jQuery.each(carrierData, function(capacity,capacityData) {\n" );
OpenWindow.document.write( "                            jQuery.each(capacityData, function(index,skuData) {\n" );
OpenWindow.document.write( "                                if (index === 0) {\n" );
OpenWindow.document.write( "                                    if( skuData.partNumber == partNum ){\n" );
OpenWindow.document.write( "                                        if( skuData.enabled ){\n" );
OpenWindow.document.write( "                                            console.log( '    found ' + partNum + ', ' + skuData.localizedAttributes.S_SKU_NAME );\n" );
OpenWindow.document.write( "                                            partNum_enabled = true;\n" );
OpenWindow.document.write( "                                            return false;\n" );
OpenWindow.document.write( "                                        }else{\n" );
OpenWindow.document.write( "                                            console.log( '    found ' + partNum + ', ' + skuData.localizedAttributes.S_SKU_NAME + ',but not enabled' );\n" );
OpenWindow.document.write( "                                        }\n" );
OpenWindow.document.write( "                                    }	\n" );
OpenWindow.document.write( "                                }\n" );
OpenWindow.document.write( "                            });	\n" );
OpenWindow.document.write( "                        });\n" );
OpenWindow.document.write( "                    }\n" );
OpenWindow.document.write( "		});	\n" );
OpenWindow.document.write( "            });\n" );
OpenWindow.document.write( "        });\n" );
OpenWindow.document.write( "    });\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    return partNum_enabled;\n" );
OpenWindow.document.write( "}\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "//向服务器请求某store的sku\n" );
OpenWindow.document.write( "function van_getsku( storeNumber ) {\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    var sku = null;\n" );
OpenWindow.document.write( "    var tag=location.href.split('/')[location.href.split('/').length-2];\n" );
OpenWindow.document.write( "    var dataString = 'tag=' + tag + '&store=' + storeNumber + '&product=' + selectedSubProduct_g;\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    jQuery.ajax({\n" );
OpenWindow.document.write( "        type: \"POST\",\n" );
OpenWindow.document.write( "        async: false,\n" );
OpenWindow.document.write( "        url: \"skusForStoreProduct\",\n" );
OpenWindow.document.write( "        dataType : \"json\",\n" );
OpenWindow.document.write( "        data: dataString,\n" );
OpenWindow.document.write( "        success: function(data) {\n" );
OpenWindow.document.write( "            if (data != null) {	\n" );
OpenWindow.document.write( "                if (data.productResponse !== undefined) {\n" );
OpenWindow.document.write( "                    sku = data.productResponse.productGroupedSku;\n" );
OpenWindow.document.write( "                    //                van_check_available( sku, 'ME457CH/A' );\n" );
OpenWindow.document.write( "                    //                van_check_available( sku, 'MF382CH/A' );\n" );
OpenWindow.document.write( "                    //                van_check_available( sku, 'MF381CH/A' );\n" );
OpenWindow.document.write( "                    \n" );
OpenWindow.document.write( "                    console.log('POST(sku) success: ' + storeNumber );\n" );
OpenWindow.document.write( "                } else {\n" );
OpenWindow.document.write( "    		    console.log('POST(sku) No data:' + storeNumber );\n" );
OpenWindow.document.write( "                }\n" );
OpenWindow.document.write( "            } else {\n" );
OpenWindow.document.write( "                console.log('POST(sku) data == NULL:' + storeNumber );\n" );
OpenWindow.document.write( "            }\n" );
OpenWindow.document.write( "        },\n" );
OpenWindow.document.write( "        error: function (xhr, ajaxOptions, thrownError) {\n" );
OpenWindow.document.write( "            console.log( \"POST(sku) err1\" );\n" );
OpenWindow.document.write( "        } 		\n" );
OpenWindow.document.write( "    }); \n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    return sku;\n" );
OpenWindow.document.write( "};\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "function van_gettime_submit(){\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    var i = 0;\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    van_getTimeslots();\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    (function doit() {\n" );
OpenWindow.document.write( "     setTimeout(function() {\n" );
OpenWindow.document.write( "                if( timeslotid_g != null ){\n" );
OpenWindow.document.write( "                van_onSubmitRequest();\n" );
OpenWindow.document.write( "                }\n" );
OpenWindow.document.write( "                if( i++ < 30 && timeslotid_g == null ) {\n" );
OpenWindow.document.write( "                console.log( i );\n" );
OpenWindow.document.write( "                van_getTimeslots();\n" );
OpenWindow.document.write( "                doit();\n" );
OpenWindow.document.write( "                }\n" );
OpenWindow.document.write( "                }, 200 );\n" );
OpenWindow.document.write( "     })();\n" );
OpenWindow.document.write( "}\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "function van_get_iphone()\n" );
OpenWindow.document.write( "{\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    var i = 0;\n" );
OpenWindow.document.write( "    var sku     		= null;\n" );
OpenWindow.document.write( "    var stores	    = null;\n" );
OpenWindow.document.write( "    var stores_all = [ \n" );
OpenWindow.document.write( "        { \"city\":\"香港\", \"store\":[ {\"num\":\"R428\", \"name\":\"香港, ifc mall\"}, {\"num\":\"R485\", \"name\":\"香港, Festival Walk\"}, {\"num\":\"R409\", \"name\":\"香港, Causeway Bay\"} ]},\n" );
OpenWindow.document.write( "        { \"city\":\"北京\", \"store\":[ {\"num\":\"R320\", \"name\":\"北京市, 三里屯\"}, {\"num\":\"R448\", \"name\":\"北京市, 王府井\"}, {\"num\":\"R388\", \"name\":\"北京市, 西单大悦城\"} ]},\n" );
OpenWindow.document.write( "        { \"city\":\"上海\", \"store\":[ {\"num\":\"R389\", \"name\":\"上海, 浦东\"}, {\"num\":\"R359\", \"name\":\"上海, 南京东路\"}, {\"num\":\"R390\", \"name\":\"上海, 香港广场\"} ]},\n" );
OpenWindow.document.write( "        { \"city\":\"深圳\", \"store\":[ {\"num\":\"R484\", \"name\":\"深圳, 深圳益田假日广场\"} ]},\n" );
OpenWindow.document.write( "        { \"city\":\"成都\", \"store\":[ {\"num\":\"R502\", \"name\":\"成都, 成都万象城\"} ]}\n" );
OpenWindow.document.write( "        //\n" );
OpenWindow.document.write( "        //    { \"city\":\"北京\", \"store\":[ \"R388\", \"R320\", \"R448\" ] },\n" );
OpenWindow.document.write( "        //    { \"city\":\"上海\", \"store\":[ \"R389\", \"R359\", \"R390\" ] },\n" );
OpenWindow.document.write( "        //    { \"city\":\"深圳\", \"store\":[ \"R484\" ] },\n" );
OpenWindow.document.write( "        //    { \"city\":\"成都\", \"store\":[ \"R502\" ] }\n" );
OpenWindow.document.write( "    ];\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    var models = [ \n" );
OpenWindow.document.write( "        { \"color\":\"金\", \"capacity\":\"16\", \"carrier\":\"香港\", \"partNum\":\"MF354ZP/A\", \"skuName\":\"iPhone 5s 16GB 金色\" },\n" );
OpenWindow.document.write( "        { \"color\":\"金\", \"capacity\":\"16\", \"carrier\":\"电信\", \"partNum\":\"MF383CH/A\", \"skuName\":\"iPhone 5s 16GB 金色 - 中国电信网络\" },\n" );
OpenWindow.document.write( "        { \"color\":\"金\", \"capacity\":\"16\", \"carrier\":\"联通\", \"partNum\":\"ME452CH/A\", \"skuName\":\"iPhone 5s 16GB 金色 - WCDMA/GSM 网络\" },\n" );
OpenWindow.document.write( "        { \"color\":\"金\", \"capacity\":\"32\", \"carrier\":\"香港\", \"partNum\":\"MF357ZP/A\", \"skuName\":\"iPhone 5s 32GB 金色\" },\n" );
OpenWindow.document.write( "        { \"color\":\"金\", \"capacity\":\"32\", \"carrier\":\"电信\", \"partNum\":\"MF386CH/A\", \"skuName\":\"iPhone 5s 32GB 金色 - 中国电信网络\" },\n" );
OpenWindow.document.write( "        { \"color\":\"金\", \"capacity\":\"32\", \"carrier\":\"联通\", \"partNum\":\"ME455CH/A\", \"skuName\":\"iPhone 5s 32GB 金色 - WCDMA/GSM 网络\" },\n" );
OpenWindow.document.write( "        { \"color\":\"金\", \"capacity\":\"64\", \"carrier\":\"香港\", \"partNum\":\"MF360ZP/A\", \"skuName\":\"iPhone 5s 64GB 金色\" },\n" );
OpenWindow.document.write( "        { \"color\":\"金\", \"capacity\":\"64\", \"carrier\":\"电信\", \"partNum\":\"MF389CH/A\", \"skuName\":\"iPhone 5s 64GB 金色 - 中国电信网络\" },\n" );
OpenWindow.document.write( "        { \"color\":\"金\", \"capacity\":\"64\", \"carrier\":\"联通\", \"partNum\":\"ME458CH/A\", \"skuName\":\"iPhone 5s 64GB 金色 - WCDMA/GSM 网络\" },\n" );
OpenWindow.document.write( "        { \"color\":\"银\", \"capacity\":\"16\", \"carrier\":\"香港\", \"partNum\":\"MF353ZP/A\", \"skuName\":\"iPhone 5s 16GB 銀色\" },\n" );
OpenWindow.document.write( "        { \"color\":\"银\", \"capacity\":\"16\", \"carrier\":\"电信\", \"partNum\":\"MF382CH/A\", \"skuName\":\"iPhone 5s 16GB 银色 - 中国电信网络\" },\n" );
OpenWindow.document.write( "        { \"color\":\"银\", \"capacity\":\"16\", \"carrier\":\"联通\", \"partNum\":\"ME451CH/A\", \"skuName\":\"iPhone 5s 16GB 银色 - WCDMA/GSM 网络\" },\n" );
OpenWindow.document.write( "        { \"color\":\"银\", \"capacity\":\"32\", \"carrier\":\"香港\", \"partNum\":\"MF356ZP/A\", \"skuName\":\"iPhone 5s 32GB 銀色\" },\n" );
OpenWindow.document.write( "        { \"color\":\"银\", \"capacity\":\"32\", \"carrier\":\"电信\", \"partNum\":\"MF385CH/A\", \"skuName\":\"iPhone 5s 32GB 银色 - 中国电信网络\" },\n" );
OpenWindow.document.write( "        { \"color\":\"银\", \"capacity\":\"32\", \"carrier\":\"联通\", \"partNum\":\"ME454CH/A\", \"skuName\":\"iPhone 5s 32GB 银色 - WCDMA/GSM 网络\" },\n" );
OpenWindow.document.write( "        { \"color\":\"银\", \"capacity\":\"64\", \"carrier\":\"香港\", \"partNum\":\"MF359ZP/A\", \"skuName\":\"iPhone 5s 64GB 銀色\" },\n" );
OpenWindow.document.write( "        { \"color\":\"银\", \"capacity\":\"64\", \"carrier\":\"电信\", \"partNum\":\"MF388CH/A\", \"skuName\":\"iPhone 5s 64GB 银色 - 中国电信网络\" },\n" );
OpenWindow.document.write( "        { \"color\":\"银\", \"capacity\":\"64\", \"carrier\":\"联通\", \"partNum\":\"ME457CH/A\", \"skuName\":\"iPhone 5s 64GB 银色 - WCDMA/GSM 网络\" },\n" );
OpenWindow.document.write( "        { \"color\":\"灰\", \"capacity\":\"16\", \"carrier\":\"香港\", \"partNum\":\"MF352ZP/A\", \"skuName\":\"iPhone 5s 16GB 太空灰\" },\n" );
OpenWindow.document.write( "        { \"color\":\"灰\", \"capacity\":\"16\", \"carrier\":\"电信\", \"partNum\":\"MF381CH/A\", \"skuName\":\"iPhone 5s 16GB 深空灰色 - 中国电信网络\" },\n" );
OpenWindow.document.write( "        { \"color\":\"灰\", \"capacity\":\"16\", \"carrier\":\"联通\", \"partNum\":\"ME450CH/A\", \"skuName\":\"iPhone 5s 16GB 深空灰色 - WCDMA/GSM 网络\" },\n" );
OpenWindow.document.write( "        { \"color\":\"灰\", \"capacity\":\"32\", \"carrier\":\"香港\", \"partNum\":\"MF355ZP/A\", \"skuName\":\"iPhone 5s 32GB 太空灰\" },\n" );
OpenWindow.document.write( "        { \"color\":\"灰\", \"capacity\":\"32\", \"carrier\":\"电信\", \"partNum\":null, \"skuName\":null },\n" );
OpenWindow.document.write( "        { \"color\":\"灰\", \"capacity\":\"32\", \"carrier\":\"联通\", \"partNum\":null, \"skuName\":null },\n" );
OpenWindow.document.write( "        { \"color\":\"灰\", \"capacity\":\"64\", \"carrier\":\"香港\", \"partNum\":\"MF358ZP/A\", \"skuName\":\"iPhone 5s 64GB 太空灰\" },\n" );
OpenWindow.document.write( "        { \"color\":\"灰\", \"capacity\":\"64\", \"carrier\":\"电信\", \"partNum\":null, \"skuName\":null },\n" );
OpenWindow.document.write( "        { \"color\":\"灰\", \"capacity\":\"64\", \"carrier\":\"联通\", \"partNum\":null, \"skuName\":null },\n" );
OpenWindow.document.write( "    ];\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    //计算城市\n" );
OpenWindow.document.write( "    jQuery.each(stores_all, function(index,cityData) {\n" );
OpenWindow.document.write( "        if( cityData.city == pickup_city_g ){\n" );
OpenWindow.document.write( "            stores = cityData.store;\n" );
OpenWindow.document.write( "            return false;\n" );
OpenWindow.document.write( "        }\n" );
OpenWindow.document.write( "    });\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    if( stores == null ){\n" );
OpenWindow.document.write( "        console.log( '城市名错误: ' + pickup_city_g );\n" );
OpenWindow.document.write( "        return;\n" );
OpenWindow.document.write( "    }\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    //计算型号\n" );
OpenWindow.document.write( "    for( i=0; i<models.length; i++ ){\n" );
OpenWindow.document.write( "        if( models[i].color == color_g &&\n" );
OpenWindow.document.write( "            models[i].capacity == capacity_g &&\n" );
OpenWindow.document.write( "            models[i].carrier == carrier_g ){\n" );
OpenWindow.document.write( "            \n" );
OpenWindow.document.write( "            partNumber_g = models[i].partNum;\n" );
OpenWindow.document.write( "            skuName_g = models[i].skuName;\n" );
OpenWindow.document.write( "            break;\n" );
OpenWindow.document.write( "        }\n" );
OpenWindow.document.write( "    }\n" );
OpenWindow.document.write( "    if( partNumber_g == null || skuName_g == null ){\n" );
OpenWindow.document.write( "        console.log( '手机型号错误: ' + color_g + ', ' + capacity_g + ', ' + carrier_g );\n" );
OpenWindow.document.write( "        return;\n" );
OpenWindow.document.write( "    }\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    for( i=0; i<stores.length; i++ ){\n" );
OpenWindow.document.write( "        console.log( \"got cha0: \" + partNumber_g + ' : ' + skuName_g + ' : ' + stores[i].name );\n" );
OpenWindow.document.write( "        \n" );
OpenWindow.document.write( "        sku = van_getsku( stores[i].num );\n" );
OpenWindow.document.write( "        if( sku != null ){\n" );
OpenWindow.document.write( "            if( van_check_available( sku, partNumber_g ) == true ){                \n" );
OpenWindow.document.write( "                selectedStore_g         = stores[i].num;\n" );
OpenWindow.document.write( "                storeName_g             = stores[i].name;\n" );
OpenWindow.document.write( "                \n" );
OpenWindow.document.write( "                //获取timeslot，然后提交\n" );
OpenWindow.document.write( "                van_gettime_submit();\n" );
OpenWindow.document.write( "                return;\n" );
OpenWindow.document.write( "            }\n" );
OpenWindow.document.write( "        }\n" );
OpenWindow.document.write( "    }\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "    if( sku != null )\n" );
OpenWindow.document.write( "        console.log( \"预约失败: 该型号在该城市的所有直营店都没货.\" );\n" );
OpenWindow.document.write( "    else\n" );
OpenWindow.document.write( "        console.log( \"预约失败: 服务器无响应.\" );\n" );
OpenWindow.document.write( "    \n" );
OpenWindow.document.write( "}\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "van_get_iphone();\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "\n" );
OpenWindow.document.write( "\n" );
}</SCRIPT></html>
